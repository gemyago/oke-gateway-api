---
description: 
globs: *.go
alwaysApply: false
---
# golang project rules, apply in agent mode

## common rules
- Build plan, ALWAYS confirm before proceeding
- Do not continue if not confirmed or approved
- TDD must be followed if adding new stuff, which means:
  1. Add stub declarations (for struct function panic not implemented)
  2. Add or extend tests that are testing desired logic
    - after extending, show command to run tests in form: 
      `gow test -v ./<package path> --run <test name>`
  3. Implement the logic
- Use mockery to create mocks for dependencies
  - add mocks to @.mockery.yaml
  - run `mockery` from root to regenerate

## Rules for tests
- prefer single toplevel func per component and do multiple nested run blocks
- define newMockDeps function in the stop of the func that will initialize dependencies (if applicable)
- define tests in same package